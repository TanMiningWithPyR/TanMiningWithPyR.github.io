{
    "collab_server" : "",
    "contents" : "---\ntitle: \"2.kmean聚类\"\nauthor: \"Affluence Tan\"\ndate: \"December 30, 2016\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n## 简单理解聚类\n\n聚类是一种无监督学习，你不必提前知道被划分的组是什么样的，甚至可能不知道你能找到什么，所以，聚类是用来发现而不是预测。\n\n### 什么是K均值聚类\n\n* 选择k个初始的类中心，类中心是可以随机选择的。\n* 将其中样本分配到最近的类中心，距离定义类似于KNN。\n* 计算每个类的质心，质心可以通过各个类的均值得到。\n* 根据新的质心重新分配样本。\n* 迭代第三，四步，直到质心不在移动。\n* 变量要求是连续变量。\n\n### 如何选择k\n\n如果没有先验的知识，经验建议为$\\sqrt{n/2}$，其中n表示样本数量。\n\n## R实战\n\n### 获取数据集\n\n在研究聚类问题的时候，我们一般需要结合业务来选择K，这里为了学习，使用R语言自带的著名的iris数据集来研究聚类问题。iris是法国的国花鸢尾花，我们先加载数据集。\n```{r iris dataset}\nstr(iris)\nsummary(iris)\n```\n可以看到，前4个变量分别是萼片的长，宽和花瓣的长，宽。最后的一个Species是iris这个花的分类，可以看到一共有三类，每个类有50个样本。在做聚类研究的时候，可以把先这个变量去掉，同时，与KNN类似的，要将变量标准化。\n\n### 整理数据集\n```{r iris nomalization}\n# Nomalize iris data\niris_n <- as.data.frame(scale(iris[-5]))\n```\n\n###训练数据集\n根据上面的探索，我们已经知道这个数据集可以分成3类了，所以k为3。在一般实际的案例中，k的值要通过业务来判断。\n```{r training a model on the data}\n iris_clusters <- kmeans(iris_n,3)\n```\n\n###评估模型\n评估聚类的结果是主观的，最终要看聚类的结果是不是对分析实际业务有用。可以先看一下每个cluster的大小和质心。\n```{r Evaluating model performance 1}\n# look at the size of the clusters\niris_clusters$size\n\n# look at the cluster centers\niris_clusters$centers\n```\n我们把原始的Species变量求平均，与上面的质心对比一下。\n```{r message=FALSE,warning=FALSE}\nlibrary(dplyr)\n```\n```{r Evaluating model performance 2}\niris_n$Species <- iris$Species\niris_by_species <- group_by(iris_n,Species) %>% summarise_each(funs(mean(.)))\niris_by_species\n```\n对比一下数据可以看出，聚类结果里面的1对应的是versicolor，聚类结果里面的2对应的是virginica，聚类结果里面的3对应的是setosa。当然，在现实的案例中，这些分类及名称通常要我们自己定义。\n\n###模型改进\n\nkmean与KNN的改进方式类似。当然，除了kmean，聚类的方法还有很多，比如层次聚类。\n\n[数据模型学习3--朴素贝叶斯](NB.html)\n",
    "created" : 1483711120842.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3151199902",
    "id" : "32C6BC53",
    "lastKnownWriteTime" : 1483711501,
    "last_content_update" : 1483711501440,
    "path" : "D:/TanMiningWithPyR.github.io/kmean.Rmd",
    "project_path" : "kmean.Rmd",
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}